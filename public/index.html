<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge, chrome=1" />
    <title>template</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="/socket.io/socket.io.js"></script>
  </head>
  <body>
    <div>
      <input id="name-input" placeholder="Enter your chosen name.">
      <button id="name-btn">Submit Name</button>
    </div>
    <div>
      <input id="id-input" placeholder="ID of recipient.">
      <input id="msg-input" placeholder="Message to send.">
      <button id="send-msg-btn">Send Message</button>
    </div>
    <div>
      <h3>Names</h3>
      <ul id="names-list"></ul>
    </div>
    <div id="msg"></div>
    <script>
      const socket = io();
      const msg = document.getElementById("msg");
      const nameInput = document.getElementById("name-input");
      const nameBtn = document.getElementById("name-btn");
      const namesList = document.getElementById("names-list");
      const sendMsgBtn = document.getElementById("send-msg-btn");
      const msgInput = document.getElementById("msg-input");
      const idInput = document.getElementById("id-input");
      sendMsgBtn.addEventListener('click', e=>{
        socket.emit('send-msg',{id:idInput.value , msg:msgInput.value});
        msgInput.value = '';
      });
      nameBtn.addEventListener('click', e=>{
        socket.emit('set-name', nameInput.value);
        nameInput.value = '';
      });
      socket.on("update-name",data=>{
        const listItem = document.getElementById(data.id);
        const me = (socket.id===data.id);
        if(listItem){
          if(me) listItem.innerHTML = `id: ${data.id}   name: <em>${data.name}</em>`;
          else listItem.innerHTML = `id: ${data.id}   name: ${data.name}`;
        }
        else{
          if(me)
            namesList.innerHTML += `<li id=${data.id}>id: ${data.id}   name: <em>${data.name}</em></li>`;
          else
            namesList.innerHTML += `<li id=${data.id}>id: ${data.id}   name: ${data.name}</li>`;
        }
      });
      socket.on("connect", () => {
        console.log("My Socket ID: ", socket.id);
      });
      socket.on("msg", data => {
        msg.innerHTML = data;
      });
      
    </script>
    <script src="main.js"></script>
  </body>
</html>
